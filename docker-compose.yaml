version: "3.9"

services:
  nginx-proxy:
    image: nginxproxy/nginx-proxy:alpine
    container_name: nginx-proxy
    restart: unless-stopped
    ports:
      - "80:80"
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock:ro

  # nextcloud: # extends doesn't work with secrets and depends_on
  #   extends:
  #     file: ./nextcloud/docker-compose.yaml
  #     service: nextcloud
  #   environment:
  #     VIRTUAL_HOST: "nextcloud.lan"
  #     VIRTUAL_PORT: "8000"

  # ngrok:
  #   image: ngrok/ngrok:alpine
  #   container_name: ngrok
  #   restart: unless-stopped
  #   command: "http nginx-proxy --region=eu --inspect=false --bind-tls=true --log=stdout"
  #   environment:
  #     - NGROK_AUTHTOKEN=${NGROK_AUTHTOKEN}

  qbittorrent:
    extends:
      file: ./qbittorrent/docker-compose.yaml
      service: qbittorrent
    environment:
      VIRTUAL_HOST: "torrent.lan"
      VIRTUAL_PORT: "8080"

  plex:
    extends:
      file: ./plex/docker-compose.yaml
      service: plex
    environment:
      VIRTUAL_HOST: "plex.lan"
      VIRTUAL_PORT: "32400"

 #  pihole:
 #   extends:
 #     file: ./pihole/docker-compose.yaml
 #     service: pihole
 #   environment:
 #     VIRTUAL_HOST: "pihole.lan"
 #     VIRTUAL_PORT: "80"
